<div class="panel panel-default">
  <div class="panel-heading"><p class="lead remove-bottom text-center">Фотографии поверхностей</p></div>
  <div class="panel-body">

    <div class="address-list">
      <div class="row">
        <div class="col-lg-12 add-bottom">
        {% if user.type != 3 %}
          {% if show_broken %}
          <a href="{{ request.path }}?broken=0" class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> Показать целые</a>
          {% else %}
          <a href="{{ request.path }}?broken=1" class="btn btn-warning"><span class="glyphicon glyphicon-wrench"></span> Показать повреждённые</a>
          {% endif %}
        {% endif %}
          {% if grid %}
            <a href="{{ request.path }}?grid=0" class="btn btn-info" title="Показать таблицей"><span class="glyphicon glyphicon-th-list"></span> Показать таблицей</a>
          {% else %}
            <a href="{{ request.path }}?grid=1" class="btn btn-info" title="Показать плиткой"><span class="glyphicon glyphicon-th"></span> Показать плиткой</a>
          {% endif %}
          <button id="js-photo-map-button" class="btn btn-info"><span class="glyphicon glyphicon-globe"></span> Показать на карте</button>
        </div>
        <div class="col-lg-12">
          <form action="" method="GET" role="form" id="js-address-filter-form" class="form-inline add-bottom">
            <select name="a_city" id="id_a_city" class="form-control input-sm" data-ajax-url="{% url 'city:get_area_list' %}">
              <option value="">Город</option>
              {% for city in city_list %}
              <option value="{{ city.id }}" {% if city.id == a_city %}selected="selected"{% endif %}>{{ city.name }}</option>
              {% endfor %}
            </select>
            <select name="a_area" id="id_a_area" class="form-control input-sm"  data-ajax-url="{% url 'city:simple_get_area_streets' %}">
              <option value="">Район</option>
              {% if area_list %}
                {% for area in area_list %}
                <option value="{{ area.id }}" {% if area.id == a_area %}selected="selected"{% endif %}>{{ area.name }}</option>
                {% endfor %}
              {% endif %}
            </select>
            <select name="a_street" id="id_a_street" class="form-control input-sm">
              <option value="">Улица</option>
              {% if street_list %}
                {% for street in street_list %}
                <option value="{{ street.id }}" {% if street.id == a_street %}selected="selected"{% endif %}>{{ street.name }}</option>
                {% endfor %}
              {% endif %}
            </select>
            <input type="text" name="a_date_s" id="id_a_date_s" placeholder="дата от" class="form-control input-sm" value="{{ a_date_s|default:'' }}">
            <input type="text" name="a_date_e" id="id_a_date_e" placeholder="дата до" class="form-control input-sm" value="{{ a_date_e|default:'' }}">
            <button class="btn btn-info btn-sm" type="submit"><span class="glyphicon glyphicon-search"></span> Искать</button>
          </form>
        </div>

        <div class="clearfix"></div>
      </div>
      <div class="row" id="js-photo-map-wrapper">
        <div id="photoMap" data-url="{% url 'city:get_photo_map' %}" style="height: 500px;"></div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <p class="lead">Итого количество фотографий: {{ photo_count|default:'0' }}</p>
        </div>
      </div>
    {% if grid %}
      <div class="row">
      {% for item in address_list %}
        <div class="col-lg-3">
          <div>
            <a href="{{ item.image.url }}" rel="group" class="js-gallery" title="{{ item.address }}, подъезд {{ item.porch.number }}">
              <img src="{{ item.image_resize.url }}" alt="{{ item.address }}, подъезд {{ item.porch.number }}">
            </a>
          </div>
          <div>
            <p class="photo_description">
              Адрес: {{ item.address }} <br>
              Подъезд: {{ item.porch.number }}, <br>
              Дата: {{ item.date }}
            </p>
          </div>
        </div>
      {% empty %}
        <div class="col-lg-12">
          <p class="alert alert-info">Фотографий не найдено</p>
        </div>
      {% endfor %}
        <div class="clearfix"></div>
      </div>
    {% else %}
      <table class="table">
        <thead>
          <tr>
            <th>Город</th>
            <th>Район</th>
            <th>Адрес</th>
            <th>Дом</th>
            <th>Подъезд</th>
            <th>Дата</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tbody>
        {% for item in address_list %}
        <tr {% if item.is_broken %}class="danger"{% endif %}>
          <td>{{ item.porch.surface.city.name }}</td>
          <td>{{ item.porch.surface.street.area.name }}</td>
          <td>{{ item.porch.surface.street.name }}</td>
          <td>{{ item.porch.surface.house_number }}</td>
          <td>{{ item.porch.number }}</td>
          <td>{{ item.date }}</td>
          <td><a href="{{ item.image.url }}" rel="group" class="js-gallery" title="{{ item.address }}, подъезд {{ item.porch.number }}">
              <span class="glyphicon glyphicon-zoom-in"></span>
            </a></td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7">
            <p class="alert alert-info">Фотографий не найдено</p>
          </td>
        </tr>
        {% endfor %}
        </tbody>
      </table>
    {% endif %}
    {% include '__includes/pagination.html' with page_obj=address_list%}
    </div>
  </div>
</div>